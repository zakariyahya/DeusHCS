@page "/add-application-user"
@attribute [Authorize]
<RadzenTabs>
    <Tabs>
        <RadzenTabsItem Text="Add Multiple Company">
            <RadzenRow>
            <RadzenAlert Shade="Radzen.Shade.Lighter" Variant="Radzen.Variant.Flat" Size="Radzen.AlertSize.Small" AlertStyle="Radzen.AlertStyle.Danger" Visible="@errorVisible">@error</RadzenAlert>
            <RadzenAlert Shade="Radzen.Shade.Lighter" Variant="Radzen.Variant.Flat" Size="Radzen.AlertSize.Small" AlertStyle="Radzen.AlertStyle.Danger" Visible="@errorExtension">@errorExt</RadzenAlert>

            <RadzenAlert Shade="Radzen.Shade.Lighter" Variant="Radzen.Variant.Flat" Size="Radzen.AlertSize.Small" AlertStyle="Radzen.AlertStyle.Info" Visible="@infoVisible">@info</RadzenAlert>
                <RadzenColumn SizeMD="12">
                    <RadzenAlert Shade="Shade.Lighter" Variant="Variant.Flat" Size="AlertSize.Small" AlertStyle="AlertStyle.Danger" Visible="@errorVisible">Cannot save Company</RadzenAlert>

                    <div class="modal-body">
                <h5>File Input</h5>
                
                @* <button @onclick="@(() => modal.Show<Register>("Modal example"))" class="btn btn-primary">view</button> *@
            @* <RadzenFileInput  TValue="string" class="w-100" OnChange=HandleFileSelected /> *@
                <BlazorInputFile.InputFile Icon="get_app" Text="Import" OnChange="HandleFileSelected" Variant="Variant.InputFile" Shade="Shade.Lighter" />
           
                @if (file != null)
                {
                        
                <table class="table">
                    <thead>
                        <tr>
                            <th>Company Id</th>
                            <th>Company Name</th>
                            <th>Email</th>
                            <th>Action</th>

                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var data in companies)
                        {
                            <tr>
                                <td>@data.Id</td>
                                <td>@data.CompanyName</td>
                                <td>@data.Email</td>
                                @* <td>@data.isMailConfirmed</td> *@
                                <td> 
                                    @if(data?.Id == companyDb?.Id){
                                        <RadzenButton  ButtonType="ButtonType.Submit" Icon="save" Text="Create All" IsBusy="@isBusy" BusyText="Registering ..." Variant="Variant.Flat" Disabled />
                                    }else{
                                        <RadzenButton Click="@AddExcel" ButtonType="ButtonType.Submit" Icon="save" Text="Create" IsBusy="@isBusy" BusyText="Registering ..." Variant="Variant.Flat" />
                                    }
                                </td>

                            </tr>
                        }
                        @* <button class="btn btn-primary"  @onclick="AddExcel">Create All</button> *@
                    </tbody>
                    @* <span style="font-weight:bold; font-size:28px;color:#c00">@Message</span> *@
                </table>
                @* <span style="font-weight:bold; font-size:15px;color:rgb(0, 204, 109)">@Message</span> *@
                }
            </div>
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.End" Gap="0.5rem">
                    <RadzenButton Click="@AddExcel" ButtonType="ButtonType.Submit" Icon="save" Text="Create All" IsBusy="@isBusy" BusyText="Registering ..." Variant="Variant.Flat" />
                    <RadzenButton ButtonStyle="ButtonStyle.Light" Text="Cancel" Click="@CancelClick" Variant="Variant.Flat" />
                </RadzenStack>
                </RadzenColumn>
            </RadzenRow>
        </RadzenTabsItem>
        <RadzenTabsItem Text="Add Single Company">
            <RadzenRow>
            @* <RadzenAlert Shade="Radzen.Shade.Lighter" Variant="Radzen.Variant.Flat" Size="Radzen.AlertSize.Small" AlertStyle="Radzen.AlertStyle.Danger" Visible="@errorVisible">@error</RadzenAlert>
            <RadzenAlert Shade="Radzen.Shade.Lighter" Variant="Radzen.Variant.Flat" Size="Radzen.AlertSize.Small" AlertStyle="Radzen.AlertStyle.Info" Visible="@infoVisible">@info</RadzenAlert> *@
                <RadzenColumn SizeMD="12">
                    <RadzenTemplateForm TItem="WebAdmin.Models.ApplicationUser" Data="@user" Visible="@(user != null)" Submit="@FormSubmit">
                        <RadzenAlert Shade="Radzen.Shade.Lighter" Variant="Radzen.Variant.Flat" Size="Radzen.AlertSize.Small" AlertStyle="Radzen.AlertStyle.Danger" Visible="@errorVisible">@error</RadzenAlert>
                        <RadzenAlert Shade="Radzen.Shade.Lighter" Variant="Radzen.Variant.Flat" Size="Radzen.AlertSize.Small" AlertStyle="Radzen.AlertStyle.Info" Visible="@infoVisible">@info</RadzenAlert>
                        <RadzenRow style="margin-bottom: 1rem">
                            <RadzenColumn SizeMD="3">
                                <RadzenLabel Component="Email" style="width: 100%" Text="Email" />
                            </RadzenColumn>
                            <RadzenColumn SizeMD="9">
                                <RadzenTextBox style="display: block; width: 100%" @bind-Value="@(user.Email)" Name="Email" />
                                <RadzenRequiredValidator Component="Email" Text="Email is required" />
                            </RadzenColumn>
                        </RadzenRow>
                        <RadzenRow style="margin-bottom: 1rem">
                            <RadzenColumn SizeMD="3">
                                <RadzenLabel Component="CompanyName" style="width: 100%" Text="Company Name" />
                            </RadzenColumn>
                            <RadzenColumn SizeMD="9">
                                <RadzenTextBox style="display: block; width: 100%" @bind-Value="@user.CompanyName" Name="CompanyName" />
                                <RadzenRequiredValidator Component="CompanyName" Text="Company Name is required" />
                            </RadzenColumn>
                        </RadzenRow>
                        @* <RadzenRow style="margin-bottom: 1rem">
                            <RadzenColumn SizeMD="3">
                                <RadzenLabel Component="RoleNames" style="width: 100%" Text="Roles" />
                            </RadzenColumn>
                            <RadzenColumn SizeMD="9">
                                <RadzenDropDown Data="@roles" Multiple="true" style="width: 100%" TextProperty="Name"
                                    @bind-Value="@(userRoles)" ValueProperty="Id" Name="Roles" />
                            </RadzenColumn>
                        </RadzenRow> *@
                        @* <RadzenRow style="margin-bottom: 1rem">
                            <RadzenColumn SizeMD="3">
                                <RadzenLabel Component="Password" style="width: 100%" Text="Password" />
                            </RadzenColumn>
                            <RadzenColumn SizeMD="9">
                                <RadzenPassword style="display: block; width: 100%" @bind-Value="@(user.Password)"
                                    Name="Password" />
                                <RadzenRequiredValidator Component="Password" Text="Password is required" />
                            </RadzenColumn>
                        </RadzenRow>
                        <RadzenRow style="margin-bottom: 1rem">
                            <RadzenColumn SizeMD="3">
                                <RadzenLabel Component="ConfirmPassword" style="width: 100%" Text="Confirm password" />
                            </RadzenColumn>
                            <RadzenColumn SizeMD="9">
                                <RadzenPassword style="display: block; width: 100%" @bind-Value="@(user.ConfirmPassword)"
                                    Name="ConfirmPassword" />
                                <RadzenRequiredValidator Component="ConfirmPassword" Text="ConfirmPassword is required" />
                                <RadzenCompareValidator Text="Passwords must match" Component="ConfirmPassword" Value="@user.Password" />
                            </RadzenColumn>
                        </RadzenRow> *@
                        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.End" Gap="0.5rem">
                                <RadzenButton ButtonType="ButtonType.Submit" Icon="save" Text="Save" IsBusy="@isBusy" BusyText="Registering ..." Variant="Variant.Flat" />
                                <RadzenButton ButtonStyle="ButtonStyle.Light" Text="Cancel" Click="@CancelClick" Variant="Variant.Flat" />
                        </RadzenStack>
                    </RadzenTemplateForm>
                </RadzenColumn>
            </RadzenRow>
        </RadzenTabsItem>
    </Tabs>
</RadzenTabs>

